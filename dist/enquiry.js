"use strict";(()=>{var D=(e,t,a)=>{$(".select-wrapper--"+t).remove();var r=document.createElement("div");r.classList.add("select-wrapper","select-wrapper--"+t);var i=document.createElement("select");i.id=t,i.name=t,i.classList.add("form-select","w-select");for(let l=0;l<e.length;l++){var n=document.createElement("option");n.text=e[l],n.value=e[l],i.add(n)}var s=document.createElement("div");s.classList.add("select-icon"),$(r).prepend(i).append(s).insertAfter("#"+a)};var u=e=>!Array.isArray(e)||!e.length,x=e=>e instanceof Date&&Object.prototype.toString.call(e)==="[object Date]"&&!isNaN(e.getTime()),O=e=>(e<10&&(e="0"+e),e);var v=(e,t)=>{var a=new Date(e),r=a.getFullYear(),i=O(a.getMonth()+1),n=a.getDate();return t?r+"-"+i+"-"+n:r+""+i+n};Array.prototype.move=function(e,t){return this.splice(t,0,this.splice(e,1)[0]),this};var J=24*60*60*1e3;var k=e=>{if(e==="complete-enquiry"){var t=JSON.parse(localStorage.getItem("enquiry")),a=0;for(let r=0;r<t.length;r++)a+=parseInt(t[r].qty);$('[data-enquiry="total"]').text(a),$('[data-enquiry="get-a-quote"]').attr("href","/complete-your-enquiry?reason=NewHireSalesQuote")}else $('[data-enquiry="get-a-quote"]').attr("href","/complete-your-enquiry");$('[data-enquiry="get-a-quote"] .'+e).show().siblings().hide()};var N=$(".modal").length<1;$(document).on("change","#billing",function(){var e=$(this).val().toLowerCase();e==="hire"?$("#date-picker").removeClass("hidden"):$("#date-picker").addClass("hidden"),$('[data-enquiry="add-to-enquiry"] .icon-check').length&&$('[data-enquiry="add-to-enquiry"]').html('<span class="button-text icon-add">Add to Enquiry</span>')});$('.increase[data-for="enquiry-ribbon"]').on("click",function(e){e.preventDefault();var t=$(this),a=t.parent(),r=a.siblings(".counter"),i=r.val();if(i>=1&&a.siblings(".interaction-button-wrapper").find(".decrease").prop("disabled",!1).removeAttr("disabled"),i<99){var n=+i+1;r.val(n).trigger("change")}});$('.decrease[data-for="enquiry-ribbon"]').on("click",function(e){e.preventDefault();var t=$(this),a=t.parent(),r=a.siblings(".counter"),i=r.val();if(i>1){i===2&&t.prop("disabled",!0).attr("disabled","");var n=+i-1;r.val(n).trigger("change")}});localStorage.getItem("enquiry")?q=JSON.parse(localStorage.getItem("enquiry")):(q=[],localStorage.setItem("enquiry",JSON.stringify(q)));var q;$(document).on("click",'[data-enquiry="add-to-enquiry-modal"]',function(e){e.preventDefault(),$("#variant-select").addClass("hidden"),$("#date-picker").addClass("hidden"),$('[data-enquiry="add-to-enquiry"] .icon-check').length&&$('[data-enquiry="add-to-enquiry"]').html('<span class="button-text icon-add">Add to Enquiry</span>');var t=$(this),a=t.closest(".content_card"),r=a.find(".product_singular_name")&&a.find(".product_singular_name").text()!==""?a.find(".product_singular_name").text():a.find(".content_card_title").text(),i=a.find('[data-node-type="commerce-add-to-cart-option-select"]').children(),n=a.find(".content_card-image").attr("src"),s=[];$.each(i,function(d){this.value!==""&&s.push(this.text)}),$('[data-enquiry="img"]').html(n),$('[data-enquiry="singular-name"]').html(r),u(s)===!1&&(D(s,"variant","variant-label"),$("#variant-select").removeClass("hidden")),$("#qty").val(1),$('.decrease[data-for="enquiry-ribbon"]').prop("disabled",!0).attr("disabled","");var l=[],o=a.find('[data-enquiry="billing"]');o.each(function(){l.push($(this).text())}),D(l,"billing","billing-label"),l[0]==="Hire"&&$("#date-picker").removeClass("hidden"),B("add-to-enquiry")});function B(e){if(document.getElementById(e)){var t=document.getElementById(e);bodyScrollLock.disableBodyScroll(t),t.scroll(0,0);var a=$("#"+e);a.removeClass("closed").addClass("opening").css("display","flex"),a.find(".modal-background").fadeIn(350),setTimeout(function(){a.removeClass("opening").addClass("open"),$(".loading").removeClass("loading")},350)}}function g(e){if(document.getElementById(e)){var t=$("#"+e);t.removeClass("open").addClass("closing"),t.find(".modal-background").fadeOut(200),setTimeout(function(){t.removeClass("closing").hide().addClass("closed");var a=document.getElementById(e);bodyScrollLock.enableBodyScroll(a)},200)}}$(".close-modal").each(function(){$(this).on("click",function(e){e.preventDefault();var t=$(e.target).closest(".modal").attr("id");g(t)})});$(".add-to-enquiry .form-select, .add-to-enquiry .input.counter, .add-to-enquiry .calendar-field").each(function(){$(this).on("change",function(){$('[data-enquiry="add-to-enquiry"] .icon-check').length&&$('[data-enquiry="add-to-enquiry"]').html('<span class="button-text icon-add">Add to Enquiry</span>')})});$('[data-enquiry="add-to-enquiry"]').on("click",function(e){e.preventDefault();var t=!0,a=JSON.parse(localStorage.getItem("enquiry")),r="",i="",n="",s="",l="",o=[],d="";if(r=$('[data-enquiry="singular-name"]').length&&$('[data-enquiry="singular-name"]').text()!==""?$('[data-enquiry="singular-name"]').text():$('[data-enquiry="name"]').text(),i=$("#variant").length&&!$("#variant-select").hasClass("hidden")?$("#variant"):$('.product-sidebar [data-node-type="commerce-add-to-cart-option-select"]').length?$('[data-node-type="commerce-add-to-cart-option-select"]'):null,n=i!==null?n.id==="variant"?i.val():i.children('[value="'+i.val()+'"]').text():"n/a",s=$(".counter").val()>0?$(".counter").val():"1",l=$("#billing").val().toLowerCase(),d=N?$('[data-enquiry="img"]').eq(0).attr("src"):$('[data-enquiry="img"]').text(),o=x($("#hire-start").datepicker("getDate"))&&x($("#hire-end").datepicker("getDate"))?[$("#hire-start").datepicker("getDate"),$("#hire-end").datepicker("getDate")]:[],localStorage.setItem("selectedDates",JSON.stringify(o)),i!==null){if(n===""||n.indexOf("Select")>-1){t=!1,i.siblings(".form-error").length||$('<div class="form-error">Please select a product to add</div>').insertAfter(i),i.trigger("focus");return}i.siblings(".form-error").remove()}if(u(a)===!1){var f=!1;for(let y=0;y<a.length&&!f;y++)if(a[y].billing===l){var c=a[y];for(var w in c)if(c.hasOwnProperty(w)&&w==="id"){var L=c[w],S;if(l==="hire"?S=o[0]&&o[1]?r.toLowerCase().replace(/[^\w]/g,"")+n.toLowerCase().replace(/[^\w]/g,"")+"startdate"+v(o[0])+"enddate"+v(o[1]):r.toLowerCase().replace(/[^\w]/g,"")+n.toLowerCase().replace(/[^\w]/g,"")+"noselecteddates":S=r.toLowerCase().replace(/[^\w]/g,"")+n.toLowerCase().replace(/[^\w]/g,""),L===S)if(l==="hire"){var m=c.selectedDates;let E=u(m)===!1,C=u(m)===!0,A=u(o)===!1,I=u(o)===!0;if((E&&A||C&&I)&&(C&&I||m[0]===o[0].toISOString()&&m[1]===o[1].toISOString())){f=!0;var b=(parseInt(c.qty,10)+parseInt(s,10)).toString();c.qty=b,localStorage.setItem("enquiry",JSON.stringify(a)),g("add-to-enquiry"),h({name:r,img:d,variant:n})}}else{f=!0;var b=(parseInt(c.qty,10)+parseInt(s,10)).toString();c.qty=b,localStorage.setItem("enquiry",JSON.stringify(a)),g("add-to-enquiry"),h({name:r,img:d,variant:n})}}}if(!f){if(l==="hire")var p={billing:l,id:o[0]&&o[1]?r.toLowerCase().replace(/[^\w]/g,"")+n.toLowerCase().replace(/[^\w]/g,"")+"startdate"+v(o[0])+"enddate"+v(o[1]):r.toLowerCase().replace(/[^\w]/g,"")+n.toLowerCase().replace(/[^\w]/g,"")+"noselecteddates",name:r,img:d,variant:n,qty:s,selectedDates:o[0]&&o[1]?o:[]};else var p={billing:l,id:r.toLowerCase().replace(/[^\w]/g,"")+n.toLowerCase().replace(/[^\w]/g,""),name:r,img:d,variant:n,qty:s};a.push(p),localStorage.setItem("enquiry",JSON.stringify(a)),g("add-to-enquiry"),h({name:r,img:d,variant:n})}}else{if(l==="hire")var p={billing:l,id:o[0]&&o[1]?r.toLowerCase().replace(/[^\w]/g,"")+n.toLowerCase().replace(/[^\w]/g,"")+"startdate"+v(o[0])+"enddate"+v(o[1]):r.toLowerCase().replace(/[^\w]/g,"")+n.toLowerCase().replace(/[^\w]/g,"")+"noselecteddates",name:r,img:d,variant:n,qty:s,selectedDates:o[0]&&o[1]?o:[]};else var p={billing:l,id:r.toLowerCase().replace(/[^\w]/g,"")+n.toLowerCase().replace(/[^\w]/g,""),name:r,img:d,variant:n,qty:s};a.push(p),localStorage.setItem("enquiry",JSON.stringify(a)),g("add-to-enquiry"),h({name:r,img:d,variant:n})}$(this).html('<span class="button-text icon-check">Added</span>'),k("complete-enquiry")});function h(e){var t=$($("#product-added").eq(0).html()),a=t.find(".product-added-image"),r=t.find(".product-added-title"),i=e.variant!=="n/a"?e.variant+" "+e.name:e.name;r.html(i),a.attr("src",e.img),$("#complete-enquiry").append(t),setTimeout(function(){t.removeClass("hidden")},50),setTimeout(function(){t.addClass("hidden"),setTimeout(function(){t.remove()},350)},5e3)}$("#filter-fleet-list").on("click",function(e){e.preventDefault(),$("#filter-column").fadeIn(200);var t=document.getElementById("filter-column");bodyScrollLock.disableBodyScroll(t),t.scroll(0,0)});$("#filter-column-close").on("click",function(e){e.preventDefault(),$("#filter-column").fadeOut(200),setTimeout(function(){var t=document.getElementById("filter-column");bodyScrollLock.enableBodyScroll(t)},200)});})();
